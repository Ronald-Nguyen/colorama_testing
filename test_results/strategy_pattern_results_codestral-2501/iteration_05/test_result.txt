TEST_STATUS: FAILURE
DIFF_STATUS: SUCCESS
RETURNCODE: 1
TIMESTAMP: 2026-02-08T21:49:49.609347

=== PYTEST STDOUT ===
============================= test session starts =============================
platform win32 -- Python 3.14.2, pytest-9.0.2, pluggy-0.1.dev945+g0cf9e32a7.d20260207
benchmark: 5.2.3 (defaults: timer=time.perf_counter disable_gc=False min_rounds=5 min_time=0.000005 max_time=1.0 calibration_precision=10 warmup=False warmup_iterations=100000)
rootdir: C:\Users\ronal\colorama_testing
configfile: pyproject.toml
plugins: anyio-4.12.1, hypothesis-6.148.8, benchmark-5.2.3, cov-7.0.0
collected 66 items

colorama\tests\ansi_test.py ...                                          [  4%]
colorama\tests\ansitowin32_test.py .......................               [ 39%]
colorama\tests\initialise_test.py ssssssssss.                            [ 56%]
colorama\tests\isatty_test.py .......                                    [ 66%]
colorama\tests\refactoring_test.py .ss.ss                                [ 75%]
colorama\tests\test_coverage.py ..F.....                                 [ 87%]
colorama\tests\winterm_test.py ........                                  [100%]

================================== FAILURES ===================================
______________________ test_ansitowin32_state_and_calls _______________________

    def test_ansitowin32_state_and_calls():
        wrapper = ansitowin32.StreamWrapper(Mock(), Mock())
        wrapper.__setstate__({"value": 1})
        assert_equal(wrapper.__getstate__()["value"], 1)
    
        wrapped = Mock()
        wrapped.closed = False
        wrapped.isatty.return_value = True
        stream = ansitowin32.AnsiToWin32(wrapped)
        stream.strip = False
        stream.convert = False
        stream.reset_all()
    
        stream.call_win32 = Mock()
        stream.convert = True
        stream.reset_all()
        stream.call_win32.assert_called_with("m", (0,))
    
        assert_equal(stream.extract_params("H", "2"), (2, 1))
        assert_equal(stream.extract_params("A", ""), (1,))
    
        call_wrapped = Mock()
        call_wrapped.closed = False
        call_wrapped.isatty.return_value = True
        call_stream = ansitowin32.AnsiToWin32(call_wrapped)
        fake_term = Mock()
        with patch.object(ansitowin32, "winterm", fake_term):
            call_stream.win32_calls = {}
            call_stream.call_win32("J", (2,))
            call_stream.call_win32("K", (1,))
            call_stream.call_win32("H", (3, 4))
>           call_stream.call_win32("A", (2,))

colorama\tests\test_coverage.py:181: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
colorama\ansitowin32.py:247: in call_win32
    self.COMMAND_STRATEGIES[command](self, params)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <colorama.ansitowin32.AnsiToWin32 object at 0x0000027878379230>
params = (2,)

    def _strategy_ABCD(self, params):
        n = params[0]
>       x, y = {'A': (0, -n), 'B': (0, n), 'C': (n, 0), 'D': (-n, 0)}[command]
                                                                      ^^^^^^^
E       NameError: name 'command' is not defined

colorama\ansitowin32.py:230: NameError
=============================== tests coverage ================================
_______________ coverage: platform win32, python 3.14.2-final-0 _______________

Name                      Stmts   Miss  Cover   Missing
-------------------------------------------------------
colorama\__init__.py          4      0   100%
colorama\ansi.py             73      0   100%
colorama\ansitowin32.py     167     20    88%   191-208, 231, 262
colorama\initialise.py       66      1    98%   70
colorama\win32.py            95      0   100%
colorama\winterm.py         136      0   100%
-------------------------------------------------------
TOTAL                       541     21    96%
=========================== short test summary info ===========================
FAILED colorama/tests/test_coverage.py::test_ansitowin32_state_and_calls - Na...
================== 1 failed, 51 passed, 14 skipped in 1.25s ===================


=== PYTEST STDERR ===

