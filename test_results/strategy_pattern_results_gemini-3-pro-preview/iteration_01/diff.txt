--- backup/ansitowin32.py
+++ refactored/ansitowin32.py
@@ -43,0 +44,29 @@
+def_strategy_m(ansi,command,params):
+forparaminparams:
+ifparaminansi.win32_calls:
+func_args=ansi.win32_calls[param]
+func=func_args[0]
+args=func_args[1:]
+kwargs=dict(on_stderr=ansi.on_stderr)
+func(*args,**kwargs)
+def_strategy_J(ansi,command,params):
+winterm.erase_screen(params[0],on_stderr=ansi.on_stderr)
+def_strategy_K(ansi,command,params):
+winterm.erase_line(params[0],on_stderr=ansi.on_stderr)
+def_strategy_Hf(ansi,command,params):
+winterm.set_cursor_position(params,on_stderr=ansi.on_stderr)
+def_strategy_ABCD(ansi,command,params):
+n=params[0]
+x,y={'A':(0,-n),'B':(0,n),'C':(n,0),'D':(-n,0)}[command]
+winterm.cursor_adjust(x,y,on_stderr=ansi.on_stderr)
+WIN32_STRATEGIES={
+'m':_strategy_m,
+'J':_strategy_J,
+'K':_strategy_K,
+'H':_strategy_Hf,
+'f':_strategy_Hf,
+'A':_strategy_ABCD,
+'B':_strategy_ABCD,
+'C':_strategy_ABCD,
+'D':_strategy_ABCD,
+}
@@ -157,18 +186,2 @@
-ifcommand=='m':
-forparaminparams:
-ifparaminself.win32_calls:
-func_args=self.win32_calls[param]
-func=func_args[0]
-args=func_args[1:]
-kwargs=dict(on_stderr=self.on_stderr)
-func(*args,**kwargs)
-elifcommandin'J':
-winterm.erase_screen(params[0],on_stderr=self.on_stderr)
-elifcommandin'K':
-winterm.erase_line(params[0],on_stderr=self.on_stderr)
-elifcommandin'Hf':
-winterm.set_cursor_position(params,on_stderr=self.on_stderr)
-elifcommandin'ABCD':
-n=params[0]
-x,y={'A':(0,-n),'B':(0,n),'C':(n,0),'D':(-n,0)}[command]
-winterm.cursor_adjust(x,y,on_stderr=self.on_stderr)
+ifcommandinWIN32_STRATEGIES:
+WIN32_STRATEGIES[command](self,command,params)